<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>忘记密码</title>
	<link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/common.css">
    <style>
    .findPwdForm  .form-list #login_name.success{
        background: url(images/ok.gif) no-repeat 95% center;
        padding-right: 50px;
    }
    #code{
        width: 110px;height: 40px;line-height: 40px;text-align: center;display: inline-block;
    }
</style>
</head>
<body>
<div class="comWidth" id="password">	
    <h1>
        <a href="#"><img src="images/logo.png" alt="皓歌服饰"></a>
    </h1>
    <span class="title">找回密码</span>	
    <div class="settings">
        <div class="findPwd" id="findPwd"> 
            <div id="process_con"> 
                <ul class="process clearfix">  
                    <li class="active" style=""><i>1</i>填写账户名</li>  
                    <li class="" style=""><i>2</i>验证身份</li>  
                    <li class="" style=""><i>3</i>设置新密码</li>  
                    <li class="complete" style=""><i>4</i>完成</li>  
                </ul>
            </div> 
            <div class="findPwdForm"> 
                <div class="form-list">
                    <input id="login_name" name="login_name" class="" type="text" placeholder="请输入手机号/邮箱号"  onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[\u4e00-\u9fa5]/g,''))" onkeyup="this.value=this.value.replace(/[\u4e00-\u9fa5]/g,'')"> 
                    <strong class="phone_tip"></strong> 
                </div>
                <div class="form-list clearfix">  
                    <input name="login_name" class="code" type="text" placeholder="输入验证码" id="img-code">
                    <img src="images/code.png" alt="" class="img_code">
                    <!-- <div id="code"></div> -->
                    <span style="margin-left: 22px;line-height: 40px;cursor: pointer;" id="codeChange">看不清？换一张</span>
                    <strong style="margin-top: 10px;display: block;" class="code_tip"></strong>
                </div>
                <input id="send_next" data-captcha="" class="ext_submit check_password" type="button" value="提交">
            </div>   
        </div>
    </div>
</div>
<div class="hr_237"></div>
<!-- 底部 -->
<div id="com-foot"> 
    <div class="inner">
        <div class="flist">         
            <h4>关于我们</h4>           
            <div><a href="javascript:void" target="_blank">公司简介</a></div>
            <div><a href="javascript:void" target="_blank">联系我们</a></div>
        </div>  
        <div class="flist">         
            <h4>友情链接</h4>           
            <div><a href="javascript:void" target="_blank">天猫商城</a>
            </div>      
            <div><a href="javascript:void" target="_blank">苏宁易购</a>
            </div>      
        </div>      
        <div class="flist">         
            <h4>新手指南</h4>           
            <div><a href="javascript:void" target="_blank">账户注册</a>
            </div>          
            <div><a href="javascript:void" target="_blank">购物流程</a>
            </div>      
        </div>
        <div class="flist">         
            <h4>支付方式</h4>           
            <div><a href="javascript:void" target="_blank">在线支付</a>
            </div>       
        </div>
        <div class="flist">         
            <h4>售后服务</h4>           
            <div><a href="javascript:void" target="_blank">退换货政策</a>
            </div>
            <div><a href="javascript:void" target="_blank">退换货流程</a>
            </div>
            <div><a href="javascript:void" target="_blank">退款说明</a>
            </div>
            <div><a href="javascript:void" target="_blank">退款帮助</a>
            </div>        
        </div>
        <div class="flist">         
            <h4>帮助</h4>           
            <div><a href="javascript:void" target="_blank">在线客服</a>
            </div>
            <div><a href="javascript:void" target="_blank">找回密码</a>
            </div>
            <div><a href="javascript:void" target="_blank">隐私说明</a>
            </div>      
        </div>      
        <div class="flist service">                     
            <img class="qrcode" src="images/code11.png" alt="">
            <h4 style="color: #666;font-size: 15px;">扫描关注微商城</h4>
        </div>      
        <div class="flist last" style="float:left;">            
            <img class="qrcode" src="images/code11.png">
            <h4 style="color: #666;font-size: 15px;">手机APP下载</h4>   
        </div>
    </div>
    <div class="record">   
        Copyright 2007-2108 xxx.com All rights Reserved 京ICP备00001号 公安网安备110112119号  出版物经营许可证新出发京批第直110120号&nbsp;
    </div>
</div>
<script src="js/jquery-1.8.3.min.js"></script>
<!-- 兼容ie input -->
<script src="js/jquery.JPlaceholder.js"></script>
<script src="js/md5.js"></script>
<script src="js/index.js"></script>
<script src="js/password.js"></script> 
<script>
    // ImgVerifyCode 获取验证码 
    $('.img_code').attr('src',upload_url+'index.php?g=Api&m=Checkcode&a=index&length=4&font_size=16&width=111&height=40&use_curve=1&use_noise=1');
    $('#codeChange').on('click',function(){
        createCode();
        $('.img_code').attr('src',upload_url+'index.php?g=Api&m=Checkcode&a=index&length=4&font_size=16&width=111&height=40&use_curve=1&use_noise=1')
    })
    $("#login_name").keydown(function(event) {  
        var reg = /^\d{11}$/;  
        var value = $(this).val();  
        var e = event || window.event || arguments.callee.caller.arguments[0];   
        if(e.keyCode === 8) {  return true; }    
        if(e.keyCode == 32) {  return false; } 
        if(reg.test(value)) { return false;}              
    });
	$('#send_next').on('click',function(){
        if($('#login_name').val() == ''){
            $('#login_name').addClass('error');
            $('.phone_tip').text('请输入手机号/邮箱/用户名');
            $('.phone_tip').css('color','#f10180');
            return false;
        }
        if($('#img-code').val() == ''){
            $('#img-code').addClass('error');
            $('strong:eq(1)').text('请输入验证码');
            $('strong:eq(1)').css('color','#f10180');
            return false;
        }
        window.location.href="password1.html"; 
	});
	$('#login_name').on('click',function(){
        $('#login_name').removeClass('error');
        $('.phone_tip').text('');
	})
	$('#img-code').on('click',function(){
        $('#img-code').removeClass('error');
        $('.code_tip').text('');
	});
    $('#login_name').blur(function(){
        if($('#login_name').val() ==''){
            $('#login_name').addClass('error');
            $('.phone_tip').text('请输入手机号/邮箱/用户名');
            $('.phone_tip').css('color','#f10180');
        }else{
            var phone = $('#login_name').val();
            console.log(phone);
            validateUserIsExist(phone);
        }                   
    });
/*验证用户是否注册接口validateUserIsExist
phone   String  手机号码/邮箱 Y   
key String  秘钥key   Y   
timestamp   Int(11) 时间戳 Y   
sign    String  签名  Y   */
function validateUserIsExist(phone){
    var timestamp = Date.parse(new Date());
    var values=['timestamp','phone'];
    var data={'timestamp':timestamp,'phone':phone};
    var sign = doSign(values,data);
    $.ajax({
        type : "post",
        url : url+'validateUserIsExist', 
        data:{'timestamp':timestamp,'key':key,'sign':sign,'phone':phone}, 
        dataType : "json",
        success : function(data){
            console.log(data);
            if( data.status == 1){
                console.log(data);
                $('#login_name').addClass('success');
                 
            }else{
                $('#login_name').addClass('error');
                $('.phone_tip').text(data.data);
                $('.phone_tip').css('color','#f10180');
            } 
        },
        error: function (a, b, c) {}  
  })
}
var code ; //在全局定义验证码  
//产生验证码  
createCode();
function createCode(){  
     code = "";   
     var codeLength = 4;//验证码的长度  
     var checkCode = document.getElementById("code");   
     var random = new Array(0,1,2,3,4,5,6,7,8,9,'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R',  
     'S','T','U','V','W','X','Y','Z');//随机数  
     for(var i = 0; i < codeLength; i++) {//循环操作  
        var index = Math.floor(Math.random()*36);//取得随机数的索引（0~35）  
        code += random[index];//根据索引取得随机数加到code上  
    }  
    checkCode.innerHTML = code;//把code值赋给验证码  

}  
//校验验证码  
function validate(){  
    var inputCode = document.getElementById("img_code").value.toUpperCase(); //取得输入的验证码并转化为大写        
    if(inputCode.length <= 0) { //若输入的验证码长度为0  
        alert("请输入验证码！"); //则弹出请输入验证码  
    }         
    else if(inputCode != code ) { //若输入的验证码与产生的验证码不一致时  
        alert("验证码输入错误！@_@"); //则弹出验证码输入错误  
        createCode();//刷新验证码  
        document.getElementById("img_code").value = "";//清空文本框  
    }         
    else { //输入正确时  
        alert("^-^"); //弹出^-^  
    }             
}  

</script>	
</body>
</html>